# App 体验全面升级计划 (v2.0)

我们将把您的需求映射到 App 开发中，进行一次全面的体验升级，重点提升视觉表现、增加游戏化挑战机制，并优化交互流程。

## 1. 视觉效果升级 (Visual Upgrade)
将 `Focus` 页面从简单的文字计时升级为**动态视觉体验**：
- **Canvas 环形进度条**：使用 `Canvas 2D` 绘制带有渐变色的环形倒计时，直观展示剩余时间/已用时间。
- **动态呼吸效果**：专注进行时，圆环带有轻微的“呼吸”动效，模拟生命力。
- **粒子庆祝特效**：任务完成时，触发全屏“彩带/烟花”粒子动画，给予强烈的视觉奖励。

## 2. 游戏化挑战机制 (Gamification)
引入“挑战”元素，提升用户的坚持动力：
- **连续打卡挑战 (Streak)**：
  - 在 `Storage` 中增加逻辑，自动计算用户的“连续专注天数”。
  - 在首页（Setup）和报告页展示“🔥 已连续专注 N 天”，中断一天即重置（或提供“复活卡”逻辑的预留）。
- **难度分级 (Difficulty Levels)**：
  - **普通模式**：允许暂停，中断仅记录次数。
  - **沉浸模式 (Hard Mode)**：**禁止手动暂停**，切出 App 直接判为任务失败（或强制扣除“专注力值”）。*(MVP v2 暂先实现 UI 选项，逻辑后续完善)*

## 3. 交互流程优化 (Flow Optimization)
- **仪式感启动**：点击“开始专注”后，增加一个 **3-2-1 全屏倒计时** 动画，帮助用户调整呼吸，进入状态。
- **流畅过渡**：任务完成时，自动弹出带有“数据概览”的模态框（Modal），用户确认后平滑切换到下一项，而非生硬的弹窗。

## 4. 执行计划 (Execution Plan)

### 第一阶段：视觉核心重构 (Day 1-2)
- [x] **Focus 页重写**：引入 `<canvas>` 组件。
- [ ] **Canvas 逻辑**：实现 `drawProgress(percent)` 函数，绘制渐变圆环。
- [ ] **动画帧循环**：使用 `requestAnimationFrame` 替代 `setInterval` 以获得 60fps 的流畅度。

### 第二阶段：数据与挑战 (Day 3)
- [ ] **Storage 升级**：增加 `calculateStreak()` 函数。
- [ ] **UI 展示**：在 Setup 页顶部增加“火焰”图标和天数展示。

### 第三阶段：反馈与特效 (Day 4)
- [ ] **庆祝动画**：移植一个轻量级的粒子系统（Confetti）。
- [ ] **启动倒计时**：实现 3-2-1 遮罩层逻辑。

---

**当前行动**：我将优先执行 **“Canvas 环形进度条”** 的开发，这是视觉升级的核心。我们将修改 `pages/focus/index.wxml` 和 `index.js`。
